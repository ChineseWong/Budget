<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Budget">
<meta name="theme-color" content="#09090b">
<title>Budget</title>
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" sizes="180x180" href="icon-180.png">
<style>
*{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;background:#09090b;overflow-x:hidden}
body{-webkit-overflow-scrolling:touch;overscroll-behavior-y:contain}
::-webkit-scrollbar{display:none}
input,select,button{font-family:-apple-system,BlinkMacSystemFont,system-ui,sans-serif;font-size:16px}
input[type=date]::-webkit-calendar-picker-indicator{filter:invert(.7)}
button{-webkit-user-select:none;user-select:none;touch-action:manipulation}
button:active{opacity:.7!important;transform:scale(.97)}
@supports(padding:env(safe-area-inset-top)){body{padding:env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left)}}
</style>
</head>
<body>
<div id="root" style="color:#71717a;font-family:system-ui;display:flex;align-items:center;justify-content:center;min-height:100vh">Loading...</div>
<script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
<script>
"use strict";
var h=React.createElement,us=React.useState,ue=React.useEffect,uc=React.useCallback,um=React.useMemo;

var fmt=function(n){if(n==null||isNaN(n))return"$0.00";var a=Math.abs(n),s=a.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});return n<0?"-$"+s:"$"+s};
var pct=function(n){return((n||0)*100).toFixed(1)+"%"};
var uid=function(){return Date.now().toString(36)+Math.random().toString(36).slice(2,7)};
var dFmt=function(d){return new Date(d+"T12:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})};
var mIdx=function(d){return new Date(d+"T12:00:00").getMonth()};
var MN=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
var td=function(){var d=new Date();return d.getFullYear()+"-"+String(d.getMonth()+1).padStart(2,"0")+"-"+String(d.getDate()).padStart(2,"0")};

var CATS=["Activities","Bets","Car Payment","Cars","Doctor","Food","Fun","Games","Gas","Gifts","Insurance","Personal","Phone","Shopping","Subscriptions","Wins/Losses"];
var FIX=["Subscriptions","Insurance","Car Payment","Phone","Fixed","Gas"];
var DSC=["Activities","Bets","Cars","Doctor","Food","Fun","Games","Gifts","Personal","Shopping"];
var SC=["Subscriptions","Insurance","Car Payment","Phone","Gas","Fixed"];
var T={bg:"#09090b",s1:"#18181b",s2:"#27272a",s3:"#3f3f46",b:"#27272a",bSub:"#1c1c1f",w:"#fafafa",w2:"#a1a1aa",w3:"#71717a",w4:"#52525b",blue:"#60a5fa",green:"#34d399",red:"#f87171",amber:"#fbbf24",purple:"#a78bfa",cyan:"#67e8f9",pink:"#f472b6",orange:"#fb923c",greenDim:"#052e16",redDim:"#450a0a"};
var PCC=["#60a5fa","#34d399","#fbbf24","#f87171","#a78bfa","#67e8f9","#f472b6","#fb923c","#a3e635","#818cf8","#2dd4bf","#e879f9"];
var IK=["k","h","r","b","y"];
var IL={k:"401k",h:"HSA",r:"Roth IRA",b:"Bitcoin",y:"HYSA/CMA"};
var GL={k:"401k",h:"HSA",r:"Roth IRA",b:"Bitcoin",e:"Emergency Fund"};
var GIM={k:"k",h:"h",r:"r",b:"b",e:"y"};

var S_PC=[],S_SP=[],S_ST={investPcts:{k:0,h:0,r:0,b:0,y:0},goalTargets:{k:0,h:0,r:0,b:0,e:0}},S_SUB=[];
var S_NW={assets:[{id:"a1",name:"Retirement",bal:0},{id:"a2",name:"Investments",bal:0},{id:"a3",name:"Savings",bal:0},{id:"a4",name:"Checking",bal:0}],liabilities:[{id:"l1",name:"Loans",bal:0},{id:"l2",name:"Credit Card",bal:0}]};
var S_NWH=[];

var KY={pc:"bw5-pc",sp:"bw5-sp",st:"bw5-st",sub:"bw5-sub",nw:"bw5-nw",nwh:"bw5-nwh",init:"bw5-init"};
function ld(){try{if(!localStorage.getItem(KY.init)){localStorage.setItem(KY.pc,JSON.stringify(S_PC));localStorage.setItem(KY.sp,JSON.stringify(S_SP));localStorage.setItem(KY.st,JSON.stringify(S_ST));localStorage.setItem(KY.sub,JSON.stringify(S_SUB));localStorage.setItem(KY.nw,JSON.stringify(S_NW));localStorage.setItem(KY.nwh,JSON.stringify(S_NWH));localStorage.setItem(KY.init,"1");return{pc:S_PC,sp:S_SP,st:S_ST,sub:S_SUB,nw:S_NW,nwh:S_NWH}}function g(k,f){try{var v=localStorage.getItem(k);return v?JSON.parse(v):f}catch(e){return f}}return{pc:g(KY.pc,S_PC),sp:g(KY.sp,S_SP),st:g(KY.st,S_ST),sub:g(KY.sub,S_SUB),nw:g(KY.nw,S_NW),nwh:g(KY.nwh,S_NWH)}}catch(e){return{pc:S_PC,sp:S_SP,st:S_ST,sub:S_SUB,nw:S_NW,nwh:S_NWH}}}
function sv(k,d){try{localStorage.setItem(k,JSON.stringify(d))}catch(e){}}

/* Donut */
function Donut(p){var data=p.data||[],colors=p.colors||PCC,sz=p.size||160,inn=p.inner||.55;var tot=0;data.forEach(function(d){tot+=d.value});if(!tot)return null;var cx=sz/2,cy=sz/2,R=sz/2-4,ri=R*inn,ang=-Math.PI/2;var paths=data.map(function(d,i){var fr=d.value/tot,a1=ang,a2=ang+fr*Math.PI*2;ang=a2;var g=data.length>1?.02:0;var dd="M"+(cx+R*Math.cos(a1+g))+","+(cy+R*Math.sin(a1+g))+" A"+R+","+R+" 0 "+(fr>.5?1:0)+" 1 "+(cx+R*Math.cos(a2-g))+","+(cy+R*Math.sin(a2-g))+" L"+(cx+ri*Math.cos(a2-g))+","+(cy+ri*Math.sin(a2-g))+" A"+ri+","+ri+" 0 "+(fr>.5?1:0)+" 0 "+(cx+ri*Math.cos(a1+g))+","+(cy+ri*Math.sin(a1+g))+" Z";return h("path",{key:i,d:dd,fill:colors[i%colors.length]})});return h("div",{style:{display:"flex",justifyContent:"center",padding:"8px 0"}},h("svg",{width:sz,height:sz},paths))}

/* Bar */
function BarC(p){var data=p.data||[],keys=p.keys||[],colors=p.colors||[T.blue,T.green,T.orange],ht=p.height||160;if(!data.length)return null;var mx=0;data.forEach(function(d){keys.forEach(function(k){if((d[k]||0)>mx)mx=d[k]})});if(!mx)mx=1;var gW=80/data.length,bW=Math.min(gW/(keys.length+.5),12);var els=[];data.forEach(function(d,di){var gx=10+di*gW+gW/2;keys.forEach(function(k,ki){var bh=(d[k]||0)/mx*70;els.push(h("rect",{key:di+"-"+ki,x:(gx-keys.length*bW/2+ki*bW)+"%",y:(80-bh)+"%",width:bW+"%",height:bh+"%",fill:colors[ki%colors.length],rx:1}))});els.push(h("text",{key:"t"+di,x:gx+"%",y:"95%",fill:T.w4,fontSize:9,textAnchor:"middle"},d.name))});var legend=p.legend?h("div",{style:{display:"flex",gap:16,justifyContent:"center",marginTop:4}},keys.map(function(k,i){return h("div",{key:i,style:{display:"flex",alignItems:"center",gap:4}},h("div",{style:{width:8,height:8,borderRadius:2,background:colors[i]}}),h("span",{style:{fontSize:11,color:T.w3}},k))})):null;return h("div",{style:{padding:"8px 0"}},h("svg",{width:"100%",height:ht,viewBox:"0 0 100 100",preserveAspectRatio:"none"},h("line",{x1:"10%",y1:"80%",x2:"90%",y2:"80%",stroke:T.b,strokeWidth:.3}),els),legend)}

/* Line */
function LineC(p){var data=p.data||[],keys=p.keys||[],colors=p.colors||[T.w,T.red,T.green],ht=p.height||160;if(data.length<2)return null;var all=[];data.forEach(function(d){keys.forEach(function(k){if(d[k]!=null)all.push(d[k])})});var mn=Math.min.apply(null,all),mx=Math.max.apply(null,all);if(mn===mx){mn-=1;mx+=1}var pd=(mx-mn)*.1;mn-=pd;mx+=pd;var els=[];keys.forEach(function(k,ki){var pts=data.map(function(d,di){return(10+di/(data.length-1)*80)+","+(80-(d[k]-mn)/(mx-mn)*70)});if(p.filled)els.push(h("polygon",{key:"f"+ki,points:"10,80 "+pts.join(" ")+" 90,80",fill:colors[ki%colors.length],fillOpacity:.12}));els.push(h("polyline",{key:"l"+ki,points:pts.join(" "),fill:"none",stroke:colors[ki%colors.length],strokeWidth:.8}));pts.forEach(function(pt,pi){var xy=pt.split(",");els.push(h("circle",{key:"c"+ki+"-"+pi,cx:xy[0]+"%",cy:xy[1]+"%",r:"1%",fill:colors[ki%colors.length]}))})});data.forEach(function(d,di){els.push(h("text",{key:"lb"+di,x:(10+di/(data.length-1)*80)+"%",y:"95%",fill:T.w4,fontSize:9,textAnchor:"middle"},d.name))});var legend=p.legend?h("div",{style:{display:"flex",gap:14,justifyContent:"center",marginTop:4,flexWrap:"wrap"}},keys.map(function(k,i){return h("div",{key:i,style:{display:"flex",alignItems:"center",gap:4}},h("div",{style:{width:8,height:8,borderRadius:2,background:colors[i]}}),h("span",{style:{fontSize:11,color:T.w3}},k))})):null;return h("div",{style:{padding:"8px 0"}},h("svg",{width:"100%",height:ht,viewBox:"0 0 100 100",preserveAspectRatio:"none"},h("line",{x1:"10%",y1:"80%",x2:"90%",y2:"80%",stroke:T.b,strokeWidth:.3}),els),legend)}

var iS={width:"100%",padding:"12px 14px",borderRadius:10,border:"1px solid "+T.b,background:T.bg,color:T.w,fontSize:16,fontFamily:"inherit",boxSizing:"border-box",outline:"none",WebkitAppearance:"none",minHeight:48};
function bS(c,o,sm,fl){return{padding:sm?"8px 14px":"14px 18px",borderRadius:10,border:o?"1.5px solid "+c:"none",background:o?"transparent":c,color:o?c:"#fff",fontSize:sm?12:14,fontWeight:600,cursor:"pointer",width:fl?"100%":"auto",fontFamily:"inherit",minHeight:sm?36:48,touchAction:"manipulation"}}

function Inp(p){return h("div",{style:Object.assign({marginBottom:14},p.sx||{})},p.label?h("div",{style:{fontSize:11,color:T.w3,fontWeight:600,marginBottom:5,letterSpacing:.8,textTransform:"uppercase"}},p.label):null,h("input",{value:p.value,onChange:function(e){p.onChange(e.target.value)},type:p.type||"text",placeholder:p.ph,step:p.type==="number"?"any":undefined,style:iS}))}
function Sel(p){return h("div",{style:{marginBottom:14}},p.label?h("div",{style:{fontSize:11,color:T.w3,fontWeight:600,marginBottom:5,letterSpacing:.8,textTransform:"uppercase"}},p.label):null,h("select",{value:p.value,onChange:function(e){p.onChange(e.target.value)},style:Object.assign({},iS,{WebkitAppearance:"none"})},p.opts.map(function(o){return h("option",{key:o,value:o},o)})))}
function Cd(p){return h("div",{onClick:p.onClick,style:Object.assign({background:T.s1,borderRadius:14,padding:18,border:"1px solid "+T.bSub},p.sx||{})},p.children)}
function SH(p){return h("div",{style:{fontSize:11,fontWeight:700,color:T.w4,textTransform:"uppercase",letterSpacing:1.8,marginBottom:10,marginTop:14}},p.children)}
function PB(p){return h("div",{style:{width:"100%",height:p.h||6,background:T.s2,borderRadius:p.h||6,overflow:"hidden"}},h("div",{style:{width:Math.min(Math.max(p.p||0,0),1)*100+"%",height:"100%",background:p.color,borderRadius:p.h||6,transition:"width .6s"}}))}

function Modal(p){var s1=us(0),dy=s1[0],setDy=s1[1];var s2=us(null),sy=s2[0],setSy=s2[1];if(!p.open)return null;return h("div",{style:{position:"fixed",inset:0,zIndex:1e3,display:"flex",alignItems:"flex-end",justifyContent:"center"},onClick:p.onClose},h("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.7)",backdropFilter:"blur(4px)"}}),h("div",{onClick:function(e){e.stopPropagation()},onTouchStart:function(e){setSy(e.touches[0].clientY)},onTouchMove:function(e){if(sy!=null)setDy(Math.max(0,e.touches[0].clientY-sy))},onTouchEnd:function(){if(dy>120)p.onClose();setDy(0);setSy(null)},style:{position:"relative",width:"100%",maxWidth:480,maxHeight:"88vh",background:T.s1,borderRadius:"20px 20px 0 0",padding:"22px 20px 34px",overflowY:"auto",WebkitOverflowScrolling:"touch",transform:"translateY("+dy+"px)",transition:dy?"none":"transform .3s"}},h("div",{style:{width:36,height:4,background:T.s3,borderRadius:2,margin:"0 auto 18px"}}),h("div",{style:{fontSize:18,fontWeight:700,marginBottom:18}},p.title),p.children))}

function App(){
  var s0=us(true),loading=s0[0],setL=s0[1];
  var s1=us(0),tab=s1[0],setTab=s1[1];
  var s2=us([]),pc=s2[0],setPc=s2[1];
  var s3=us([]),sp=s3[0],setSp=s3[1];
  var s4=us(S_ST),st=s4[0],setSt=s4[1];
  var s5=us([]),sub=s5[0],setSub=s5[1];
  var s6=us(S_NW),nw=s6[0],setNw=s6[1];
  var s7=us([]),nwh=s7[0],setNwh=s7[1];
  var s8=us(null),modal=s8[0],setModal=s8[1];

  ue(function(){var d=ld();setPc(d.pc);setSp(d.sp);setSt(d.st);setSub(d.sub);setNw(d.nw);setNwh(d.nwh);setL(false)},[]);
  var sPC=uc(function(d){setPc(d);sv(KY.pc,d)},[]);
  var sSP=uc(function(d){setSp(d);sv(KY.sp,d)},[]);
  var sST=uc(function(d){setSt(d);sv(KY.st,d)},[]);
  var sSUB=uc(function(d){setSub(d);sv(KY.sub,d)},[]);
  var sNW=uc(function(d){setNw(d);sv(KY.nw,d)},[]);
  var sNWH=uc(function(d){setNwh(d);sv(KY.nwh,d)},[]);

  var ppData=um(function(){var sorted=pc.slice().sort(function(a,b){return a.date.localeCompare(b.date)});var noWL=sp.filter(function(s){return s.cat!=="Wins/Losses"});var allP=sorted.map(function(p){return p.period});var run=0;return sorted.map(function(p,i){var ps=noWL.filter(function(s){if(s.pid>0){if(allP.indexOf(s.pid)>=0)return s.pid===p.period;return i===sorted.length-1}var st2=i===0?"2000-01-01":p.date;var en=i<sorted.length-1?sorted[i+1].date:"2099-12-31";return s.date>=st2&&s.date<en});var fixS=ps.filter(function(e){return FIX.indexOf(e.cat)>=0}).reduce(function(a,e){return a+e.amt},0);var discS=ps.filter(function(e){return DSC.indexOf(e.cat)>=0}).reduce(function(a,e){return a+e.amt},0);var totI=IK.reduce(function(a,k){return a+(p.inv[k]||0)},0);var dB=p.gross-totI-fixS;if(i>0)run=run+dB-discS;return Object.assign({},p,{fixS:fixS,discS:discS,totalSpend:fixS+discS,totInv:totI,discBudget:dB,discRemaining:run,periodSpend:ps})})},[pc,sp]);

  var D=um(function(){var aPC=pc.filter(function(p){return p.gross>0});var gYTD=aPC.reduce(function(s,p){return s+p.gross},0);var inv={k:0,h:0,r:0,b:0,y:0};aPC.forEach(function(p){IK.forEach(function(k){inv[k]+=(p.inv[k]||0)})});var tInv=Object.values(inv).reduce(function(a,b){return a+b},0);var noWL=sp.filter(function(s){return s.cat!=="Wins/Losses"});var tSp=noWL.reduce(function(s,e){return s+e.amt},0);var byCat={};noWL.forEach(function(e){byCat[e.cat]=(byCat[e.cat]||0)+e.amt});var catArr=Object.entries(byCat).sort(function(a,b){return b[1]-a[1]}).map(function(e){return{cat:e[0],total:e[1],pct:tSp>0?e[1]/tSp:0}});var monthly=MN.map(function(m,mi){var mS=noWL.filter(function(e){return mIdx(e.date)===mi});var mP=aPC.filter(function(p){return mIdx(p.date)===mi});var inc=mP.reduce(function(s,p){return s+p.gross},0);var invested=mP.reduce(function(s,p){return s+IK.reduce(function(a,k){return a+(p.inv[k]||0)},0)},0);var fix=mS.filter(function(e){return FIX.indexOf(e.cat)>=0}).reduce(function(s,e){return s+e.amt},0);var disc=mS.filter(function(e){return DSC.indexOf(e.cat)>=0}).reduce(function(s,e){return s+e.amt},0);return{month:m,income:inc,invested:invested,fixed:fix,disc:disc,total:fix+disc,cf:inc-invested-fix-disc}});var wl=sp.filter(function(s){return s.cat==="Wins/Losses"}).reduce(function(s,e){return s+e.amt},0);var tA=nw.assets.reduce(function(s,a){return s+a.bal},0);var tL=nw.liabilities.reduce(function(s,l){return s+l.bal},0);var dR=ppData.length>0?ppData[ppData.length-1].discRemaining:0;return{gYTD:gYTD,inv:inv,tInv:tInv,tSp:tSp,sRate:gYTD>0?tInv/gYTD:0,catArr:catArr,monthly:monthly,wl:wl,tA:tA,tL:tL,netW:tA-tL,dR:dR,nCF:gYTD-tInv-tSp}},[pc,sp,nw,ppData]);

  function addPC(d){sPC(pc.concat([Object.assign({},d,{id:uid()})]).sort(function(a,b){return a.date.localeCompare(b.date)}))}
  function editPC(id,u){sPC(pc.map(function(p){return p.id===id?Object.assign({},p,u):p}))}
  function delPC(id){sPC(pc.filter(function(p){return p.id!==id}))}
  function addSP(d){sSP(sp.concat([Object.assign({},d,{id:uid()})]))}
  function editSP(id,u){sSP(sp.map(function(e){return e.id===id?Object.assign({},e,u):e}))}
  function delSP(id){sSP(sp.filter(function(e){return e.id!==id}))}
  function expJSON(){var b=new Blob([JSON.stringify({paychecks:pc,spending:sp,settings:st,subscriptions:sub,netWorth:nw,netWorthHistory:nwh},null,2)],{type:"application/json"});var u=URL.createObjectURL(b);var a=document.createElement("a");a.href=u;a.download="budget-"+td()+".json";a.click();URL.revokeObjectURL(u)}
  function expCSV(){var rows=[["Date","Category","Amount","Note"]].concat(sp.filter(function(s){return s.cat!=="Wins/Losses"}).sort(function(a,b){return a.date.localeCompare(b.date)}).map(function(e){return[e.date,e.cat,e.amt,e.note||""]}));var csv=rows.map(function(r){return r.join(",")}).join("\n");var b=new Blob([csv],{type:"text/csv"});var u=URL.createObjectURL(b);var a=document.createElement("a");a.href=u;a.download="spending-"+td()+".csv";a.click();URL.revokeObjectURL(u)}
  function saveNWH(up){sNW(up);var tA=up.assets.reduce(function(s,a){return s+a.bal},0);var tL=up.liabilities.reduce(function(s,l){return s+l.bal},0);sNWH(nwh.filter(function(x){return x.date!==td()}).concat([{date:td(),assets:tA,liabilities:tL,net:tA-tL}]).sort(function(a,b){return a.date.localeCompare(b.date)}))}

  var tabs=["Overview","Monthly","Periods","Spending","Goals","Bills","Net Worth","Settings"];
  if(loading)return h("div",{style:{minHeight:"100vh",background:T.bg,display:"flex",alignItems:"center",justifyContent:"center"}},h("div",{style:{color:T.w3}},"Loading..."));

  return h("div",{style:{minHeight:"100vh",background:T.bg,color:T.w,fontFamily:"-apple-system,BlinkMacSystemFont,system-ui,sans-serif",maxWidth:480,margin:"0 auto",paddingBottom:80}},
    h("div",{style:{padding:"24px 20px 10px",position:"sticky",top:0,background:T.bg,zIndex:100}},h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"}},h("div",null,h("div",{style:{fontSize:20,fontWeight:700}},"Budget"),h("div",{style:{fontSize:12,color:T.w4,marginTop:2}},"2026")),h("div",{style:{display:"flex",gap:8}},h("button",{style:Object.assign({},bS(T.green),{padding:"10px 16px",fontSize:12}),onClick:function(){setModal("addPC")}},"+Pay"),h("button",{style:Object.assign({},bS(T.s3),{padding:"10px 16px",fontSize:12,color:T.w2}),onClick:function(){setModal("addSP")}},"+Spend")))),
    h("div",{style:{display:"flex",gap:6,padding:"8px 20px 6px",overflowX:"auto",scrollbarWidth:"none"}},tabs.map(function(t,i){return h("button",{key:i,onClick:function(){setTab(i)},style:{padding:"10px 14px",borderRadius:8,border:"none",fontSize:12,fontWeight:600,cursor:"pointer",flexShrink:0,background:tab===i?T.w:"transparent",color:tab===i?T.bg:T.w4,fontFamily:"inherit",minHeight:44}},t)})),
    h("div",{style:{padding:"12px 20px 20px"}},
      tab===0?h(OvTab,{D:D,st:st}):tab===1?h(MoTab,{D:D,pc:pc,sm:setModal}):tab===2?h(PPTab,{pp:ppData,sm:setModal}):tab===3?h(SpTab,{D:D,sp:sp,sm:setModal}):tab===4?h(GoTab,{D:D,st:st}):tab===5?h(BiTab,{sub:sub,sm:setModal}):tab===6?h(NWTab,{nw:nw,D:D,nwh:nwh,sm:setModal}):h(SeTab,{st:st,sST:sST,ej:expJSON,ec:expCSV})
    ),
    h(APCM,{open:modal==="addPC",onClose:function(){setModal(null)},onSave:function(d){addPC(d);setModal(null)},st:st,nextP:pc.length>0?Math.max.apply(null,pc.map(function(p){return p.period}))+1:1}),
    h(EPCM,{open:modal&&modal.t==="ePC",data:modal&&modal.t==="ePC"?modal.d:null,onClose:function(){setModal(null)},onSave:function(id,u){editPC(id,u);setModal(null)},onDel:function(id){delPC(id);setModal(null)}}),
    h(ASPM,{open:modal==="addSP",onClose:function(){setModal(null)},onSave:function(d){addSP(d);setModal(null)},pc:pc}),
    h(ESPM,{open:modal&&modal.t==="eSP",data:modal&&modal.t==="eSP"?modal.d:null,onClose:function(){setModal(null)},onSave:function(id,u){editSP(id,u);setModal(null)},onDel:function(id){delSP(id);setModal(null)},pc:pc}),
    h(ASuM,{open:modal==="addSub",onClose:function(){setModal(null)},onSave:function(d){sSUB(sub.concat([Object.assign({},d,{id:uid()})]));setModal(null)}}),
    h(ESuM,{open:modal&&modal.t==="eSub",data:modal&&modal.t==="eSub"?modal.d:null,onClose:function(){setModal(null)},onSave:function(id,u){sSUB(sub.map(function(s){return s.id===id?Object.assign({},s,u):s}));setModal(null)},onDel:function(id){sSUB(sub.filter(function(s){return s.id!==id}));setModal(null)}}),
    h(ENWM,{open:modal&&modal.t==="eNW",items:modal&&modal.t==="eNW"?modal.items:null,kind:modal&&modal.t==="eNW"?modal.kind:null,onClose:function(){setModal(null)},onSave:function(u){saveNWH(u);setModal(null)},nw:nw})
  )
}

/* MODALS */
function APCM(p){var s1=us(td()),date=s1[0],setDate=s1[1];var s2=us(""),gross=s2[0],setGross=s2[1];var s3=us(true),auto=s3[0],setAuto=s3[1];var s4=us({k:"",h:"",r:"",b:"",y:""}),inv=s4[0],setInv=s4[1];ue(function(){if(p.open){setDate(td());setGross("");setAuto(true);setInv({k:"",h:"",r:"",b:"",y:""})}},[p.open]);var g=parseFloat(gross)||0;var fI={};IK.forEach(function(k){fI[k]=auto?+(g*(p.st.investPcts[k]||0)).toFixed(2):parseFloat(inv[k])||0});var tI=Object.values(fI).reduce(function(a,b){return a+b},0);return h(Modal,{open:p.open,onClose:p.onClose,title:"Add Paycheck"},h(Inp,{label:"Date",value:date,onChange:setDate,type:"date"}),h(Inp,{label:"Gross Pay",value:gross,onChange:setGross,type:"number",ph:"0.00"}),h("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:14}},h("input",{type:"checkbox",checked:auto,onChange:function(){setAuto(!auto)},style:{accentColor:T.blue}}),h("span",{style:{fontSize:13,color:T.w3}},"Auto-calculate from %")),!auto?h("div",{style:{background:T.bg,borderRadius:12,padding:14,marginBottom:14}},IK.map(function(k){return h(Inp,{key:k,label:IL[k],value:inv[k],onChange:function(v){var n=Object.assign({},inv);n[k]=v;setInv(n)},type:"number",ph:"0.00"})})):null,g>0?h(Cd,{sx:{marginBottom:16,background:T.bg}},IK.map(function(k){return h("div",{key:k,style:{display:"flex",justifyContent:"space-between",padding:"4px 0",fontSize:13,color:T.w3}},h("span",null,IL[k]),h("span",{style:{color:T.green,fontWeight:600}},fmt(fI[k])))}),h("div",{style:{borderTop:"1px solid "+T.b,marginTop:8,paddingTop:8,display:"flex",justifyContent:"space-between",fontSize:13,fontWeight:700}},h("span",null,"Invested"),h("span",{style:{color:T.green}},fmt(tI))),h("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:T.amber,marginTop:4}},h("span",null,"Remaining"),h("span",null,fmt(g-tI)))):null,h("button",{style:bS(T.green,false,false,true),onClick:function(){if(date&&g>=0)p.onSave({date:date,period:p.nextP,gross:g,inv:fI})}},"Save Paycheck"))}

function EPCM(p){var s1=us(""),date=s1[0],setDate=s1[1];var s2=us(""),gross=s2[0],setGross=s2[1];var s3=us({k:"",h:"",r:"",b:"",y:""}),inv=s3[0],setInv=s3[1];ue(function(){if(p.data){setDate(p.data.date);setGross(String(p.data.gross));var i={};IK.forEach(function(k){i[k]=String(p.data.inv[k]||0)});setInv(i)}},[p.data]);if(!p.data)return null;return h(Modal,{open:p.open,onClose:p.onClose,title:"Edit Paycheck"},h(Inp,{label:"Date",value:date,onChange:setDate,type:"date"}),h(Inp,{label:"Gross",value:gross,onChange:setGross,type:"number"}),h("div",{style:{background:T.bg,borderRadius:12,padding:14,marginBottom:14}},IK.map(function(k){return h(Inp,{key:k,label:IL[k],value:inv[k],onChange:function(v){var n=Object.assign({},inv);n[k]=v;setInv(n)},type:"number"})})),h("div",{style:{display:"flex",gap:10}},h("button",{style:bS(T.red,true,false,true),onClick:function(){p.onDel(p.data.id)}},"Delete"),h("button",{style:bS(T.green,false,false,true),onClick:function(){var fi={};IK.forEach(function(k){fi[k]=parseFloat(inv[k])||0});p.onSave(p.data.id,{date:date,gross:parseFloat(gross)||0,inv:fi})}},"Save")))}

function ASPM(p){var s1=us(td()),date=s1[0],setDate=s1[1];var s2=us("Food"),cat=s2[0],setCat=s2[1];var s3=us(""),amt=s3[0],setAmt=s3[1];var s4=us(""),note=s4[0],setNote=s4[1];var s5=us(0),pid=s5[0],setPid=s5[1];ue(function(){if(p.open){setDate(td());setCat("Food");setAmt("");setNote("");setPid(p.pc.length>0?Math.max.apply(null,p.pc.map(function(x){return x.period})):0)}},[p.open,p.pc]);var periods=p.pc.map(function(x){return x.period}).sort(function(a,b){return b-a});return h(Modal,{open:p.open,onClose:p.onClose,title:"Add Spending"},h(Inp,{label:"Date",value:date,onChange:setDate,type:"date"}),h(Sel,{label:"Category",value:cat,onChange:setCat,opts:CATS}),h(Inp,{label:"Amount",value:amt,onChange:setAmt,type:"number",ph:"0.00"}),periods.length>0?h(Sel,{label:"Pay Period",value:pid,onChange:function(v){setPid(parseInt(v))},opts:periods.map(String)}):null,h(Inp,{label:"Note (optional)",value:note,onChange:setNote,ph:"What was this for?"}),h("button",{style:bS(T.green,false,false,true),onClick:function(){if(parseFloat(amt)&&date)p.onSave({date:date,cat:cat,amt:parseFloat(amt),note:note,pid:pid})}},"Add Entry"))}

function ESPM(p){var s1=us(""),date=s1[0],setDate=s1[1];var s2=us("Food"),cat=s2[0],setCat=s2[1];var s3=us(""),amt=s3[0],setAmt=s3[1];var s4=us(""),note=s4[0],setNote=s4[1];var s5=us(0),pid=s5[0],setPid=s5[1];ue(function(){if(p.data){setDate(p.data.date);setCat(p.data.cat);setAmt(String(p.data.amt));setNote(p.data.note||"");setPid(p.data.pid||0)}},[p.data]);if(!p.data)return null;var periods=p.pc.map(function(x){return x.period}).sort(function(a,b){return b-a});return h(Modal,{open:p.open,onClose:p.onClose,title:"Edit Entry"},h(Inp,{label:"Date",value:date,onChange:setDate,type:"date"}),h(Sel,{label:"Category",value:cat,onChange:setCat,opts:CATS}),h(Inp,{label:"Amount",value:amt,onChange:setAmt,type:"number"}),periods.length>0?h(Sel,{label:"Pay Period",value:pid,onChange:function(v){setPid(parseInt(v))},opts:periods.map(String).concat(["0"])}):null,h(Inp,{label:"Note",value:note,onChange:setNote}),h("div",{style:{display:"flex",gap:10}},h("button",{style:bS(T.red,true,false,true),onClick:function(){p.onDel(p.data.id)}},"Delete"),h("button",{style:bS(T.green,false,false,true),onClick:function(){p.onSave(p.data.id,{date:date,cat:cat,amt:parseFloat(amt)||0,note:note,pid:pid})}},"Save")))}

function ASuM(p){var s1=us(""),name=s1[0],setName=s1[1];var s2=us(""),cost=s2[0],setCost=s2[1];var s3=us("Subscriptions"),cat=s3[0],setCat=s3[1];ue(function(){if(p.open){setName("");setCost("");setCat("Subscriptions")}},[p.open]);return h(Modal,{open:p.open,onClose:p.onClose,title:"Add Subscription"},h(Inp,{label:"Name",value:name,onChange:setName,ph:"e.g. Netflix"}),h(Inp,{label:"Monthly Cost",value:cost,onChange:setCost,type:"number",ph:"0.00"}),h(Sel,{label:"Category",value:cat,onChange:setCat,opts:SC}),h("button",{style:bS(T.green,false,false,true),onClick:function(){if(name&&parseFloat(cost))p.onSave({name:name,cost:parseFloat(cost),cat:cat})}},"Add"))}

function ESuM(p){var s1=us(""),name=s1[0],setName=s1[1];var s2=us(""),cost=s2[0],setCost=s2[1];var s3=us("Subscriptions"),cat=s3[0],setCat=s3[1];ue(function(){if(p.data){setName(p.data.name);setCost(String(p.data.cost));setCat(p.data.cat)}},[p.data]);if(!p.data)return null;return h(Modal,{open:p.open,onClose:p.onClose,title:"Edit Subscription"},h(Inp,{label:"Name",value:name,onChange:setName}),h(Inp,{label:"Monthly Cost",value:cost,onChange:setCost,type:"number"}),h(Sel,{label:"Category",value:cat,onChange:setCat,opts:SC}),h("div",{style:{display:"flex",gap:10}},h("button",{style:bS(T.red,true,false,true),onClick:function(){p.onDel(p.data.id)}},"Delete"),h("button",{style:bS(T.green,false,false,true),onClick:function(){p.onSave(p.data.id,{name:name,cost:parseFloat(cost)||0,cat:cat})}},"Save")))}

function ENWM(p){var s1=us([]),rows=s1[0],setRows=s1[1];ue(function(){if(p.items)setRows(p.items.map(function(d){return Object.assign({},d,{bal:String(d.bal)})}))},[p.items]);if(!p.items)return null;return h(Modal,{open:p.open,onClose:p.onClose,title:"Edit "+(p.kind==="assets"?"Assets":"Liabilities")},rows.map(function(r,i){return h("div",{key:r.id||i,style:{display:"flex",gap:8,marginBottom:10,alignItems:"flex-end"}},h(Inp,{label:i===0?"Name":null,value:r.name,onChange:function(v){var n=rows.slice();n[i]=Object.assign({},n[i],{name:v});setRows(n)},sx:{flex:1,marginBottom:0}}),h(Inp,{label:i===0?"Balance":null,value:r.bal,onChange:function(v){var n=rows.slice();n[i]=Object.assign({},n[i],{bal:v});setRows(n)},type:"number",sx:{flex:1,marginBottom:0}}),h("button",{style:Object.assign({},bS(T.red,true,true),{flexShrink:0,height:40}),onClick:function(){setRows(rows.filter(function(_,j){return j!==i}))}},"X"))}),h("button",{style:Object.assign({},bS(T.blue,true,true),{marginBottom:16}),onClick:function(){setRows(rows.concat([{id:uid(),name:"",bal:"0"}]))}},"+Add"),h("button",{style:bS(T.green,false,false,true),onClick:function(){var pr=rows.filter(function(r){return r.name}).map(function(r){return Object.assign({},r,{bal:parseFloat(r.bal)||0})});p.onSave(p.kind==="assets"?Object.assign({},p.nw,{assets:pr}):Object.assign({},p.nw,{liabilities:pr}))}},"Save"))}

/* TABS */
function OvTab(p){var D=p.D,st=p.st;var invArr=IK.map(function(k){return{name:IL[k],ytd:D.inv[k],pctT:st.investPcts[k]||0}});var invPie=invArr.filter(function(i){return i.ytd>0}).map(function(i){return{name:i.name,value:i.ytd}});var rc=D.dR>=0?T.green:T.red;return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h(Cd,{sx:{borderColor:(D.dR>=0?T.green:T.red)+"30"}},h("div",{style:{fontSize:11,color:T.w4,fontWeight:600,letterSpacing:1,textTransform:"uppercase"}},"Discretionary Remaining"),h("div",{style:{fontSize:32,fontWeight:800,color:rc,letterSpacing:-1,marginTop:4}},fmt(D.dR)),h("div",{style:{fontSize:12,color:T.w4,marginTop:4}},"Rolling balance across pay periods")),h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10}},[["Income",D.gYTD,T.w],["Invested",D.tInv,T.green],["Spent",D.tSp,T.red],["Cash Flow",D.nCF,D.nCF>=0?T.green:T.red]].map(function(x,i){return h(Cd,{key:i,sx:{padding:14}},h("div",{style:{fontSize:11,color:T.w4}},x[0]),h("div",{style:{fontSize:18,fontWeight:700,color:x[2],marginTop:4}},fmt(x[1])))})),h(Cd,null,h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:10}},h("span",{style:{fontSize:12,color:T.w3}},"Savings Rate"),h("span",{style:{fontSize:22,fontWeight:800,color:T.green}},pct(D.sRate))),h(PB,{p:D.sRate,color:T.green})),h(SH,null,"Investments"),h(Cd,null,h(Donut,{data:invPie}),invArr.map(function(inv,i){var a=D.gYTD>0?inv.ytd/D.gYTD:0;return h("div",{key:i,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 0",borderTop:i>0?"1px solid "+T.bSub:"none"}},h("div",{style:{display:"flex",alignItems:"center",gap:8}},h("div",{style:{width:8,height:8,borderRadius:"50%",background:PCC[i]}}),h("span",{style:{fontSize:13}},inv.name)),h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:14,fontWeight:600}},fmt(inv.ytd)),h("div",{style:{fontSize:11,color:a>=inv.pctT?T.green:T.amber}},pct(a)+" / "+pct(inv.pctT))))})),h(SH,null,"Top Spending"),h(Cd,null,D.catArr.slice(0,6).map(function(s,i){return h("div",{key:i,style:{marginBottom:i<5?12:0}},h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:4}},h("span",{style:{fontSize:13}},s.cat),h("span",{style:{fontSize:13,color:T.w3,fontWeight:600}},fmt(s.total))),h(PB,{p:s.pct,color:PCC[i]}))})))}

function MoTab(p){var D=p.D,pc=p.pc,sm=p.sm;var active=D.monthly.filter(function(m){return m.income>0||m.total>0});var cd=active.map(function(m){return{name:m.month,Invested:m.invested,Fixed:m.fixed,Disc:m.disc}});var trend=D.monthly.filter(function(m){return m.income>0}).map(function(m){return{name:m.month,Income:+m.income.toFixed(2),Spent:+m.total.toFixed(2),Invested:+m.invested.toFixed(2)}});return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},trend.length>1?[h(SH,{key:"sh"},"Trend"),h(Cd,{key:"tr"},h(LineC,{data:trend,keys:["Income","Spent","Invested"],colors:[T.w,T.red,T.green],legend:true}))]:null,h(SH,null,"Breakdown"),cd.length>0?h(Cd,null,h(BarC,{data:cd,keys:["Invested","Fixed","Disc"],colors:[T.green,T.blue,T.orange],legend:true})):null,D.monthly.map(function(m,mi){if(m.income===0&&m.total===0)return null;var mPC=pc.filter(function(x){return mIdx(x.date)===mi&&x.gross>0});return h(Cd,{key:mi},h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}},h("span",{style:{fontSize:16,fontWeight:700}},m.month),h("span",{style:{fontSize:11,padding:"3px 10px",borderRadius:20,background:m.total>m.income?T.redDim:T.greenDim,color:m.total>m.income?T.red:T.green,fontWeight:600}},m.total>m.income?"Over":"Under")),h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8}},[["Income",m.income,T.w],["Invested",m.invested,T.green],["Fixed",m.fixed,T.blue],["Disc.",m.disc,T.orange],["Total",m.total,T.red],["CF",m.cf,m.cf>=0?T.green:T.red]].map(function(x,j){return h("div",{key:j,style:{padding:"8px 10px",background:T.bg,borderRadius:10}},h("div",{style:{fontSize:10,color:T.w4}},x[0]),h("div",{style:{fontSize:14,fontWeight:700,color:x[2],marginTop:2}},fmt(x[1])))})),mPC.length>0?h("div",{style:{marginTop:10}},mPC.map(function(x){return h("div",{key:x.id,onClick:function(){sm({t:"ePC",d:x})},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px",background:T.bg,borderRadius:10,marginBottom:4,cursor:"pointer",minHeight:48}},h("span",{style:{fontSize:12,color:T.w3}},dFmt(x.date)+" PP"+x.period),h("span",{style:{fontSize:13,fontWeight:600,color:T.green}},fmt(x.gross)))})):null)}))}

function PPTab(p){var ppD=p.pp,sm=p.sm;var active=ppD.filter(function(x){return x.gross>0});var cd=active.map(function(x){return{name:"PP"+x.period,Budget:+x.discBudget.toFixed(2),Spent:+x.discS.toFixed(2)}});var cd2=active.map(function(x){return{name:"PP"+x.period,Remaining:+x.discRemaining.toFixed(2)}});return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h(SH,null,"Pay Period Overview"),cd.length>0?h(Cd,null,h(BarC,{data:cd,keys:["Budget","Spent"],colors:[T.blue,T.orange],legend:true}),h(LineC,{data:cd2,keys:["Remaining"],colors:[T.green],filled:true,height:100})):null,active.map(function(pp){var over=pp.discS>pp.discBudget;return h(Cd,{key:pp.id},h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12}},h("div",{style:{display:"flex",alignItems:"center",gap:8}},h("span",{style:{fontSize:16,fontWeight:700}},"PP"+pp.period),h("span",{style:{fontSize:11,padding:"3px 10px",borderRadius:20,background:over?T.redDim:T.greenDim,color:over?T.red:T.green,fontWeight:600}},over?"Over":"Under")),h("span",{style:{fontSize:12,color:T.w4}},dFmt(pp.date))),h("div",{onClick:function(){sm({t:"ePC",d:pp})},style:{cursor:"pointer",padding:"12px 14px",background:T.bg,borderRadius:10,marginBottom:10,display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:48}},h("span",{style:{fontSize:12,color:T.w3}},"Gross"),h("span",{style:{fontSize:14,fontWeight:700}},fmt(pp.gross))),h("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,marginBottom:10}},[["Invested",pp.totInv,T.green],["Fixed",pp.fixS,T.blue],["Disc Budget",pp.discBudget,T.w],["Disc Spent",pp.discS,T.orange]].map(function(x,j){return h("div",{key:j,style:{padding:"8px 10px",background:T.bg,borderRadius:10}},h("div",{style:{fontSize:10,color:T.w4}},x[0]),h("div",{style:{fontSize:14,fontWeight:700,color:x[2],marginTop:2}},fmt(x[1])))})),h("div",{style:{padding:"10px 14px",background:T.bg,borderRadius:10,display:"flex",justifyContent:"space-between",alignItems:"center",border:"1px solid "+(pp.discRemaining>=0?T.green:T.red)+"20"}},h("span",{style:{fontSize:12,color:T.w3}},"Running Remaining"),h("span",{style:{fontSize:18,fontWeight:800,color:pp.discRemaining>=0?T.green:T.red}},fmt(pp.discRemaining))),pp.periodSpend.length>0?h("details",{style:{marginTop:10}},h("summary",{style:{fontSize:12,color:T.blue,cursor:"pointer",fontWeight:600}},pp.periodSpend.length+" transactions"),h("div",{style:{marginTop:6}},pp.periodSpend.sort(function(a,b){return a.date.localeCompare(b.date)}).map(function(e,j){return h("div",{key:e.id,onClick:function(){sm({t:"eSP",d:e})},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 8px",borderTop:j>0?"1px solid "+T.bSub:"none",cursor:"pointer",fontSize:12,minHeight:44}},h("div",null,h("span",{style:{fontWeight:500}},e.cat),h("span",{style:{color:T.w4,marginLeft:6}},dFmt(e.date))),h("span",{style:{fontWeight:600,color:e.amt<0?T.green:T.w}},fmt(e.amt)))}))):null)}))}

function SpTab(p){var D=p.D,sp=p.sp,sm=p.sm;var s1=us("All"),filter=s1[0],setFilter=s1[1];var s2=us(""),search=s2[0],setSearch=s2[1];var noWL=sp.filter(function(s){return s.cat!=="Wins/Losses"});var searched=search?noWL.filter(function(e){return(e.cat+" "+(e.note||"")+" "+e.date).toLowerCase().indexOf(search.toLowerCase())>=0}):noWL;var filtered=filter==="All"?searched:searched.filter(function(s){return s.cat===filter});var sorted=filtered.slice().sort(function(a,b){return b.date.localeCompare(a.date)});var pieData=D.catArr.filter(function(s){return s.total>0}).map(function(s){return{name:s.cat,value:s.total}});return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h("div",{style:{display:"flex",gap:8}},h(Cd,{sx:{flex:1,textAlign:"center",padding:14}},h("div",{style:{fontSize:10,color:T.w4}},"Total Spent"),h("div",{style:{fontSize:18,fontWeight:700,color:T.red,marginTop:2}},fmt(D.tSp))),h(Cd,{sx:{flex:1,textAlign:"center",padding:14}},h("div",{style:{fontSize:10,color:T.w4}},"Wins/Losses"),h("div",{style:{fontSize:18,fontWeight:700,color:D.wl>=0?T.green:T.red,marginTop:2}},fmt(D.wl)))),pieData.length>0?h(Cd,null,h(Donut,{data:pieData}),D.catArr.filter(function(s){return s.total>0}).map(function(s,i){return h("div",{key:i,style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"7px 0",borderTop:i>0?"1px solid "+T.bSub:"none"}},h("div",{style:{display:"flex",alignItems:"center",gap:8}},h("div",{style:{width:8,height:8,borderRadius:2,background:PCC[i]}}),h("span",{style:{fontSize:12}},s.cat)),h("div",null,h("span",{style:{fontSize:13,fontWeight:600}},fmt(s.total)),h("span",{style:{fontSize:11,color:T.w4,marginLeft:6}},pct(s.pct))))})):null,h(SH,null,"Log"),h("input",{value:search,onChange:function(e){setSearch(e.target.value)},placeholder:"Search...",style:Object.assign({},iS,{marginBottom:8})}),h("div",{style:{display:"flex",gap:6,overflowX:"auto",scrollbarWidth:"none",paddingBottom:4}},["All"].concat(CATS.filter(function(c){return c!=="Wins/Losses"})).map(function(c){return h("button",{key:c,onClick:function(){setFilter(c)},style:{padding:"8px 14px",borderRadius:8,border:"none",fontSize:12,fontWeight:600,cursor:"pointer",flexShrink:0,background:filter===c?T.w:"transparent",color:filter===c?T.bg:T.w4,fontFamily:"inherit",minHeight:40}},c)})),h(Cd,{sx:{padding:10}},sorted.length===0?h("div",{style:{padding:20,textAlign:"center",color:T.w4,fontSize:13}},"No entries"+(search?" matching search":"")):null,sorted.slice(0,80).map(function(e,i){return h("div",{key:e.id,onClick:function(){sm({t:"eSP",d:e})},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 10px",borderTop:i>0?"1px solid "+T.bSub:"none",cursor:"pointer",minHeight:52}},h("div",null,h("div",{style:{fontSize:13,fontWeight:500}},e.cat),h("div",{style:{fontSize:11,color:T.w4}},dFmt(e.date)+(e.note?" Â· "+e.note:""))),h("span",{style:{fontSize:14,fontWeight:600,color:e.amt<0?T.green:T.w,flexShrink:0,marginLeft:8}},fmt(e.amt)))})))}

function GoTab(p){var D=p.D,st=p.st;return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h(SH,null,"Savings Goals"),Object.entries(GL).map(function(entry,i){var k=entry[0],name=entry[1],target=st.goalTargets[k]||0,cur=D.inv[GIM[k]]||0,pr=target>0?cur/target:0,col=pr>=1?T.green:pr>=.25?T.blue:T.red;return h(Cd,{key:i},h("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:10}},h("div",{style:{fontSize:15,fontWeight:700}},name),h("span",{style:{fontSize:11,color:T.w4,background:T.bg,padding:"3px 10px",borderRadius:8}},pr>=1?"Done":"In Progress")),h(PB,{p:pr,color:col,h:8}),h("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10}},h("div",null,h("div",{style:{fontSize:10,color:T.w4}},"Current"),h("div",{style:{fontSize:15,fontWeight:700,color:col}},fmt(cur))),h("div",{style:{textAlign:"center"}},h("div",{style:{fontSize:10,color:T.w4}},"Progress"),h("div",{style:{fontSize:15,fontWeight:700,color:col}},pct(pr))),h("div",{style:{textAlign:"right"}},h("div",{style:{fontSize:10,color:T.w4}},"Remaining"),h("div",{style:{fontSize:15,fontWeight:700,color:T.w3}},fmt(Math.max(0,target-cur))))),h("div",{style:{fontSize:11,color:T.w4,marginTop:8,textAlign:"center"}},"Target: "+fmt(target)))}))}

function BiTab(p){var sub=p.sub,sm=p.sm;var total=sub.reduce(function(s,x){return s+x.cost},0);var grouped={};sub.forEach(function(s){if(!grouped[s.cat])grouped[s.cat]=[];grouped[s.cat].push(s)});return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h("button",{style:bS(T.s3,false,false,true),onClick:function(){sm("addSub")}},h("span",{style:{color:T.w2}},"+Add Subscription")),h("div",{style:{display:"flex",gap:8}},h(Cd,{sx:{flex:1,textAlign:"center",padding:14}},h("div",{style:{fontSize:10,color:T.w4}},"Monthly"),h("div",{style:{fontSize:18,fontWeight:700,color:T.blue,marginTop:2}},fmt(total))),h(Cd,{sx:{flex:1,textAlign:"center",padding:14}},h("div",{style:{fontSize:10,color:T.w4}},"Annual"),h("div",{style:{fontSize:18,fontWeight:700,color:T.amber,marginTop:2}},fmt(total*12)))),Object.entries(grouped).map(function(entry,gi){return h(Cd,{key:gi},h("div",{style:{fontSize:11,fontWeight:700,color:T.w4,marginBottom:10,letterSpacing:1,textTransform:"uppercase"}},entry[0]),entry[1].map(function(s,i){return h("div",{key:s.id,onClick:function(){sm({t:"eSub",d:s})},style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 4px",borderTop:i>0?"1px solid "+T.bSub:"none",cursor:"pointer",minHeight:48}},h("span",{style:{fontSize:13}},s.name),h("div",{style:{textAlign:"right"}},h("span",{style:{fontSize:14,fontWeight:600}},fmt(s.cost)),h("span",{style:{fontSize:10,color:T.w4}},"/mo")))}))}))}

function NWTab(p){var nw=p.nw,D=p.D,nwh=p.nwh,sm=p.sm;var aD=nw.assets.filter(function(a){return a.bal>0}).map(function(a){return{name:a.name,value:a.bal}});var lD=nw.liabilities.filter(function(l){return l.bal>0}).map(function(l){return{name:l.name,value:l.bal}});var hist=nwh.map(function(x){return{name:dFmt(x.date),Assets:x.assets,Liabilities:x.liabilities,Net:x.net}});return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h(Cd,{sx:{textAlign:"center"}},h("div",{style:{fontSize:11,color:T.w4,fontWeight:600,letterSpacing:1}},"NET WORTH"),h("div",{style:{fontSize:32,fontWeight:800,color:D.netW>=0?T.green:T.red,letterSpacing:-1,marginTop:4}},fmt(D.netW)),h("div",{style:{display:"flex",justifyContent:"center",gap:28,marginTop:12}},h("div",null,h("div",{style:{fontSize:10,color:T.w4}},"Assets"),h("div",{style:{fontSize:16,fontWeight:700,color:T.green}},fmt(D.tA))),h("div",{style:{width:1,background:T.b}}),h("div",null,h("div",{style:{fontSize:10,color:T.w4}},"Liabilities"),h("div",{style:{fontSize:16,fontWeight:700,color:T.red}},fmt(D.tL))))),hist.length>1?[h(SH,{key:"sh"},"History"),h(Cd,{key:"ch"},h(LineC,{data:hist,keys:["Assets","Liabilities","Net"],colors:[T.green,T.red,T.blue],legend:true}))]:h(Cd,null,h("div",{style:{fontSize:13,color:T.w4,textAlign:"center",padding:10}},"History appears after second update")),h("div",{style:{display:"flex",gap:8}},[[aD,"Assets",T.green,[T.green,T.cyan,T.blue,T.purple]],[lD,"Liabilities",T.red,[T.red,T.orange,T.pink]]].map(function(x,idx){return h(Cd,{key:idx,sx:{flex:1,padding:10}},h(Donut,{data:x[0],colors:x[3],size:110,inner:.5}),h("div",{style:{textAlign:"center",fontSize:11,color:x[2],fontWeight:600}},x[1]))})),[["assets",nw.assets,T.green,"Assets"],["liabilities",nw.liabilities,T.red,"Liabilities"]].map(function(x){return h(Cd,{key:x[0]},h("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8}},h("span",{style:{fontSize:12,fontWeight:700,color:x[2]}},x[3]),h("button",{style:bS(x[2],true,true),onClick:function(){sm({t:"eNW",items:x[1],kind:x[0]})}},"Edit")),x[1].map(function(a,i){return h("div",{key:a.id,style:{display:"flex",justifyContent:"space-between",padding:"8px 0",borderTop:i>0?"1px solid "+T.bSub:"none"}},h("span",{style:{fontSize:13}},a.name),h("span",{style:{fontSize:14,fontWeight:600,color:a.bal>0?x[2]:T.w4}},fmt(a.bal)))}),h("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:8,borderTop:"1px solid "+T.b,marginTop:4}},h("span",{style:{fontWeight:700}},"Total"),h("span",{style:{fontWeight:700,color:x[2]}},fmt(x[1].reduce(function(s,a){return s+a.bal},0)))))}))}

function SeTab(p){var st=p.st,sST=p.sST;var s1=us(Object.assign({},st.investPcts)),pcts=s1[0],setPcts=s1[1];var s2=us(Object.assign({},st.goalTargets)),goals=s2[0],setGoals=s2[1];var s3=us(false),saved=s3[0],setSaved=s3[1];var s4=us(false),resetC=s4[0],setResetC=s4[1];function handleSave(){var pr={},g={};Object.entries(pcts).forEach(function(e){pr[e[0]]=parseFloat(e[1])||0});Object.entries(goals).forEach(function(e){g[e[0]]=parseFloat(e[1])||0});sST({investPcts:pr,goalTargets:g});setSaved(true);setTimeout(function(){setSaved(false)},2e3)}function handleReset(){try{Object.values(KY).forEach(function(k){localStorage.removeItem(k)})}catch(e){}window.location.reload()}var totalPct=Object.values(pcts).reduce(function(s,v){return s+(parseFloat(v)||0)},0);return h("div",{style:{display:"flex",flexDirection:"column",gap:14}},h(SH,null,"Investment %"),h(Cd,null,IK.map(function(k){return h("div",{key:k,style:{display:"flex",alignItems:"center",gap:10,marginBottom:10}},h("span",{style:{fontSize:13,minWidth:80}},IL[k]),h("input",{value:pcts[k],onChange:function(e){var n=Object.assign({},pcts);n[k]=e.target.value;setPcts(n)},type:"number",step:"0.01",style:Object.assign({},iS,{flex:1})}),h("span",{style:{fontSize:11,color:T.w4,minWidth:40}},pct(parseFloat(pcts[k])||0)))}),h("div",{style:{display:"flex",justifyContent:"space-between",paddingTop:8,borderTop:"1px solid "+T.b}},h("span",{style:{fontSize:13,fontWeight:600}},"Total"),h("span",{style:{fontSize:14,fontWeight:700,color:totalPct<=1?T.green:T.red}},pct(totalPct)))),h(SH,null,"Goal Targets"),h(Cd,null,Object.entries(GL).map(function(entry){return h("div",{key:entry[0],style:{display:"flex",alignItems:"center",gap:10,marginBottom:10}},h("span",{style:{fontSize:12,minWidth:110}},entry[1]),h("input",{value:goals[entry[0]],onChange:function(e){var n=Object.assign({},goals);n[entry[0]]=e.target.value;setGoals(n)},type:"number",style:Object.assign({},iS,{flex:1})}))})),h("button",{style:bS(T.green,false,false,true),onClick:handleSave},saved?"Saved!":"Save Settings"),h(SH,null,"Export"),h(Cd,null,h("div",{style:{fontSize:12,color:T.w3,marginBottom:12}},"Download for backup."),h("div",{style:{display:"flex",gap:10}},h("button",{style:bS(T.blue,true,false,true),onClick:p.ej},"JSON"),h("button",{style:bS(T.purple,true,false,true),onClick:p.ec},"CSV"))),h(SH,null,"Reset"),h(Cd,{sx:{borderColor:T.red+"20"}},h("div",{style:{fontSize:12,color:T.w3,marginBottom:10}},"Restore to empty. Cannot be undone."),!resetC?h("button",{style:bS(T.red,true,false,true),onClick:function(){setResetC(true)}},"Reset All Data"):h("div",{style:{display:"flex",gap:10}},h("button",{style:bS(T.s3,true,false,true),onClick:function(){setResetC(false)}},"Cancel"),h("button",{style:bS(T.red,false,false,true),onClick:handleReset},"Confirm"))))}

try{ReactDOM.createRoot(document.getElementById("root")).render(h(App))}catch(e){document.getElementById("root").innerHTML="<div style='padding:40px;color:#f87171;font-family:system-ui'>Error: "+e.message+"</div>"}
</script>
<script>if("serviceWorker"in navigator)navigator.serviceWorker.register("sw.js").catch(function(){})</script>
</body>
</html>